!function(i){var t=function(i){var t=["webkit","Moz","o","ms"],e="";for(var n in t)if(e=t[n]+"Transition",void 0!==i.style[e])return"-"+t[n].toLowerCase()+"-";return!1}(document.createElement(e)),e=function(){function e(t,e){this.setting=i.extend(!0,i.fn.FullPageSlide.defaults,e||{}),this.element=t,this.init()}return e.prototype={init:function(){var t=this;this.d_sectionWrap=this.element.find(".section-wrapper"),this.d_section=this.d_sectionWrap.find(".section"),this.s_navMenu=this.setting.navMenu,this.s_author=this.setting.author,this.s_direction=this._disposeDirection(),this.s_isScrolling=this.setting.isScrolling,this.s_index=this.setting.index>=0&&this.setting.index<this._getSectionCount()?this.setting.index:0,this.s_sectionColor=this.setting.sectionColor,this.s_active=this.setting.active,this.s_isLoop=this.setting.isLoop,this.s_duration=this.setting.duration,this.s_easing=this.setting.easing,this.s_isKeyboard=this.setting.isKeyboard,this.s_afterLoad=this.setting.afterLoad,this.s_onLeave=this.setting.onLeave,this.b_tiggerSection=[],this.b_canScroll=!0,this.b_navActive="."+this.s_active,this.b_sectionW=i(window).width(),this.b_sectionH=i(window).height(),this.renderNav(),this.s_isScrolling?this.s_direction?this._initVertiLayout():this._initHorizLayout():this.s_direction?(this._initVertiLayout(),i("html, body").css({height:t.b_sectionH,overflow:"hidden"})):(this._initHorizLayout(),i("html, body").css({height:t.b_sectionW,overflow:"hidden"})),this.scrollAnimate(),this._initEvent(),this._afterScrolling(),this._setMenuActive(),t._isReTopHeader(),t._dynamicPageSize(),t._setSectionColor()},renderNav:function(){var t=this;if(this.s_navMenu.length>0){var e=i('<header class="topHeader"><h1 class="author menu-item"><a href="javascript:;">'+this.s_author+'</a></h1><nav class="topNav"><ul></ul></nav></header>');this.element.append(e),this.d_topHeader=i(".topHeader"),this.d_topHeader.css({position:"absolute",top:t.d_section.eq(1).position().top,left:0,boxSizing:"border-box"});var n=i(".topHeader .topNav ul");i.each(t.s_navMenu,function(t,e){var s=i('<li class="menu-item"><a href="javascript:;">'+e+"</a></li>");n.append(s)})}},prevSlide:function(){this.s_index>0?this.s_index--:this.s_isLoop&&(this.s_index=this._getSectionCount()-1),this._setMenuActive(),this.scrollAnimate()},nextSlide:function(){this.s_index<this._getSectionCount()-1?this.s_index++:this.s_isLoop&&(this.s_index=0),this._setMenuActive(),this.scrollAnimate()},scrollAnimate:function(){var e=this;this._isReTopHeader(),this._dynamicPageSize();var n=this.d_section.eq(e.s_index).position();if(this.s_isScrolling&&e.s_isScrolling&&e.s_direction)e.s_direction?i("body").animate({scrollTop:Math.ceil(n.top)},e.s_duration):i("body").animate({scrollLeft:Math.ceil(n.left)},e.s_duration);else if(e.d_sectionWrap.find(".topHeader").remove(),e.element.append(this.d_topHeader),this.d_topHeader.addClass("topHeader-fixed"),this._leavingSection(),n=e.s_index?e.s_direction?e.d_section.eq(e.s_index).position().top-e.d_section.eq(0).position().top:e.d_section.eq(e.s_index).position().left-e.d_section.eq(0).position().left:0,this.b_canScroll=!1,t){var s=e.s_direction?"translateY(-"+n+"px)":"translateX(-"+n+"px)";e.d_sectionWrap.css(t+"transition","all "+e.s_duration+"ms "+e.s_easing),e.d_sectionWrap.css(t+"transform",s)}else{var o=this.s_direction?{top:-n.top}:{left:-n.left};e.d_sectionWrap.animate(o,e.s_duration,function(){e.b_canScroll=!0})}},_setMenuActive:function(){var i=this;i.d_topHeader.find(".menu-item").removeClass(i.s_active),i.d_topHeader.find(".menu-item a").css({color:"#fff"}),i.d_topHeader.find(".menu-item").eq(i.s_index).addClass(i.s_active),i.d_topHeader.find(".menu-item."+i.s_active+" a").css({color:"#ccc"})},_setSectionColor:function(){var t=this;this.s_sectionColor&&i.each(t.s_sectionColor,function(i,e){t.d_section.eq(i).css({backgroundColor:e})})},_getSectionCount:function(){return this.d_section.length},_getSectionWrapSize:function(){return this.s_direction?this.element.height():this.element.width()},_initVertiLayout:function(){var t=this;i("html, body").css({height:t.b_sectionH*t._getSectionCount()}),this.d_section.css({height:t.b_sectionH}),this.d_topHeader.removeClass("topHeader-fixed")},_initHorizLayout:function(){var i=this,t=100*i._getSectionCount()+"%",e=(100/i._getSectionCount()).toFixed(4)+"%";i.d_sectionWrap.width(t),i.d_section.width(e).css({float:"left"})},_disposeDirection:function(){if("vertical"===this.setting.direction)return!0;if("horizontal"===this.setting.direction)return!1;throw Error("direction参数错误.")},_initEvent:function(){var e=this;i(".topHeader .menu-item").each(function(t){i(this).on("click",function(){return e.s_index=t,e.scrollAnimate(),e._setMenuActive(),!1})}),i(window).on("scroll",function(){e._isReTopHeader()}),i(window).on("scroll",e._deBounce(function(){e._linkageScrolling(),e.d_section.removeClass(e.s_active),e.d_section.eq(e.s_index).addClass(e.s_active)},300)),this.element.on("mousewheel DOMMouseScroll",function(i){var t=i.originalEvent.wheelDelta||-i.originalEvent.detail;e.d_section.removeClass(e.s_active),e.d_section.eq(e.s_index).addClass(e.s_active),!e.b_canScroll||e.s_direction&&e.s_isScrolling||(t<0&&(e.s_index<e._getSectionCount()-1&&!e.s_isLoop||e.s_isLoop)?e.nextSlide():t>0&&(e.s_index&&!e.s_isLoop||e.s_isLoop)&&e.prevSlide())}),this.s_isKeyboard&&!this.s_isScrolling&&i(window).keydown(function(i){var t=i.keyCode;e.d_section.removeClass(e.s_active),e.d_section.eq(e.s_index).addClass(e.s_active),37==t||38==t?e.prevSlide():39!=t&&40!=t||e.nextSlide()});i(window).on("resize",e._deBounce(function(){console.log("1"),e.b_sectionH=i(window).height(),e.b_sectionW=i(window).width(),i("html,body,.section").css({width:e.b_sectionW,height:e.b_sectionH}),e.d_topHeader.css({top:e.d_section.eq(1).position().top}),e._setMenuActive(),e.scrollAnimate()},150)),t&&e.d_sectionWrap.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend",function(){e.b_canScroll=!0})},_afterScrolling:function(){var t=this,e=this.s_index;i.isFunction(t.s_afterLoad)&&t.s_afterLoad.call(this,e+1)},_leavingSection:function(){var t=this,e=this.d_sectionWrap.find(this.b_navActive).index()+1,n=t.s_index+1;n>=t._getSectionCount()+1&&(n=0),i.isFunction(t.s_onLeave)&&t.s_onLeave.call(this,e,n)},_linkageScrolling:function(){var i=this;this.s_index=this._currentIndex(),this._isReTopHeader(),this._setMenuActive(),i._afterScrolling(),i._leavingSection()},_currentIndex:function(){var t=this,e=t.b_tiggerSection.length-1,n=t._dunamicScrollValue();return i.each(t.b_tiggerSection,function(i,s){var o=t.b_tiggerSection[i],a=t.b_tiggerSection[i+1];if(!a||n>=o&&n<a)return e=i,!1}),e},_isReTopHeader:function(){this._dunamicScrollValue()>this.d_sectionWrap.children().eq(1).position().top&&this.s_isScrolling&&this.element.find(".topHeader").addClass("topHeader-fixed"),this._dunamicScrollValue()<this.d_section.eq(1).position().top&&this.s_isScrolling&&this.element.find(".topHeader").removeClass("topHeader-fixed")},_dunamicScrollValue:function(){return this.s_direction?i(window).scrollTop():i(window).scrollLeft()},_dynamicPageSize:function(){var t=this;t.b_tiggerSection=[],i.each(t.d_section,function(i,e){t.s_direction?t.b_tiggerSection.push(t.d_section.eq(i).position().top-1):t.b_tiggerSection.push(t.d_section.eq(i).position().left-1)})},_deBounce:function(i,t,e){var n;return function(){clearTimeout(n),n=setTimeout(i,t)}}},e}();i.fn.FullPageSlide=function(t){this.each(function(){var n=i(this),s=n.data("FullPageSlide");if(s||(s=new e(n,t),n.data("FullPageSlide",s)),"string"===i.type(t))return s[t]()})},i.fn.FullPageSlide.defaults={navMenu:[],author:"",active:"active",sectionColor:[],index:0,easing:"ease",duration:500,direction:"vertical",isLoop:!1,isScrolling:!0,isKeyboard:!0,isSlimscroll:!1,afterLoad:"",onLeave:""},i(function(){i("[data-fullpageslide]").FullPageSlide()})}(jQuery);
